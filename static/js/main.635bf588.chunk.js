(this["webpackJsonpkaraoke-front"]=this["webpackJsonpkaraoke-front"]||[]).push([[0],{178:function(e,t,n){},179:function(e,t,n){},202:function(e,t,n){},204:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(23),s=n.n(a),i=n(88),o=n(32),u=n(13),d=n(5),l=n(11),j=n.n(l),b=n(25),f=n(78),g=n(33),O=n.n(g),p=new function e(t){var n=this;Object(f.a)(this,e),this.instance=void 0,this.get=function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.instance.get(t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",Promise.reject());case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),console.log("baseURL",t),this.instance=O.a.create({baseURL:t})}("https://karaoke-back.herokuapp.com/"),m=n(6),v=n(27),h=n(48),x=n(79),y=n.n(x),_=n(3),k=function(e){var t=e.imageSrc,n=e.title,c=e.focused,r=e.id,a=e.index,s=Object(d.f)();return Object(_.jsx)(m.Card,{focused:c,className:y.a.song_card,scaleOnFocus:!0,onClick:function(){s.push("/song/".concat(r))},children:Object(_.jsxs)(m.CardBody,{children:[Object(_.jsx)(m.CardMedia,{src:t,ratio:"1/1"}),Object(_.jsx)(m.CardContent,{children:Object(_.jsxs)(m.CardHeadline2,{children:[a,".\xa0",n]})})]})})};k.defaultProps={};var C=k,S=n(8),w=(n(57),n(34));function N(e){var t=Object(S.a)({},e);return{actions:Object.keys(t).reduce((function(e,t){return Object(S.a)(Object(S.a)({},e),{},Object(w.a)({},t,(n=t,function(e){return{type:n,payload:e}})));var n}),{}),reducer:function(e,n){return t[n.type](e,n.payload)}}}var R=N({setSongs:function(e,t){return Object(S.a)(Object(S.a)({},e),{},{songs:t})}}),B=R.actions,P=R.reducer,F=Object(c.memo)((function(e){var t=e.dispatch,n=e.appState.songs,r=B.setSongs;Object(c.useEffect)((function(){(function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get("/songs");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(e){var n=e.data;t(r(n))}))}),[]);var a=Object(h.isSberBox)(),s=a?300:30,i=a?1500:150,o=Object(m.useRemoteHandlers)({initialIndex:0,axis:"x",delay:s,longDelay:i,min:0,max:1}),d=Object(u.a)(o,2),l=d[0],f=d[1];return Object(_.jsx)(m.Container,{children:Object(_.jsx)(m.CarouselGridWrapper,{children:Object(_.jsx)(m.Carousel,{as:v.Row,axis:"x",index:l,animatedScrollByIndex:!0,scrollSnapType:"mandatory",detectActive:!0,detectThreshold:.5,onIndexChange:function(e){f(e)},paddingStart:"50%",paddingEnd:"50%",style:{paddingTop:"5rem",paddingBottom:"1rem"},scrollAlign:"start",children:n.concat(n).map((function(e,t){return Object(_.jsx)(m.CarouselCol,{scrollSnapAlign:"start",size:4,children:Object(_.jsx)(C,{index:t+1,title:e.title,focused:t===l,imageSrc:e.image_link,id:e._id},"item:".concat(t))})}))})})})})),L=(n(178),n(84)),I=(n(179),{song:{audio_link:"",image_link:"",lyrics:"",title:"",_id:""},isLoading:!0,isPlaying:!1,volume:.5}),E=N({setSong:function(e,t){return Object(S.a)(Object(S.a)({},e),{},{song:t})},setPlayingFlag:function(e,t){return Object(S.a)(Object(S.a)({},e),{},{isPlaying:t})},setLoadingFlag:function(e,t){return Object(S.a)(Object(S.a)({},e),{},{isLoading:t})},setVolume:function(e,t){return Object(S.a)(Object(S.a)({},e),{},{volume:t})}}),A=E.actions,T=E.reducer,D=function(e){var t=Object(d.g)().songId,n=Object(c.useRef)(null),r=Object(c.useRef)(null),a=Object(c.useRef)(),s=A.setSong,i=A.setPlayingFlag,o=A.setLoadingFlag,l=A.setVolume,f=Object(c.useReducer)(T,I),g=Object(u.a)(f,2),O=g[0],v=g[1],h=O.song,x=O.isPlaying,y=O.isLoading,k=O.volume;Object(c.useEffect)((function(){v(o(!0)),function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=t,p.get("/songs/".concat(n))));case 1:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}()().then((function(e){var t=e.data;v(s(t))})).finally((function(){v(o(!1))}))}),[]);var C=h.audio_link,S=h.image_link,w=h.lyrics;Object(c.useEffect)((function(){n.current&&r.current&&(a.current=new L.a(r.current,n.current),a.current.setLyrics(w.replaceAll("\\n","\n")))}),[h]);var N=x?function(){n.current&&(n.current.pause(),v(i(!1)))}:function(){n.current&&(n.current.play(),v(i(!0)))},R=x?"pause_button":"play_button",B={background:"url(".concat(S,") center / cover no-repeat")};return Object(_.jsxs)("div",{className:"song_page",children:[y?Object(_.jsx)("div",{className:"spinner_wrapper",children:Object(_.jsx)(m.Spinner,{})}):Object(_.jsxs)("div",{className:"controls",children:[Object(_.jsxs)("div",{className:"volume",children:[Object(_.jsx)(m.Stepper,{showRemove:!0,value:10*k,step:1,min:0,max:10,disabled:!1,onChange:function(e){if(n.current){var t=e/10;n.current.volume=t,v(l(t))}},onRemove:function(){},className:"volume_control"}),Object(_.jsx)("img",{className:"volume_icon",src:"/volume.svg",width:20,height:20})]}),Object(_.jsxs)("div",{className:"image_container",onClick:N,children:[Object(_.jsx)("div",{className:"song_image",style:B}),Object(_.jsx)("div",{className:R})]})]}),Object(_.jsx)(m.Card,{className:"lyrics_card",children:Object(_.jsx)(m.CardBody,{children:Object(_.jsxs)(m.CardContent,{children:[C&&Object(_.jsx)("audio",{id:"audio-1",ref:n,onEnded:function(){v(i(!1))},children:Object(_.jsx)("source",{src:C,type:"audio/mpeg"})}),Object(_.jsx)("div",{id:"lyrics-1",className:"rabbit-lyrics","data-media":"#audio-1",ref:r,"data-view-mode":"mini",children:w})]})})})]})};D.defaultProps={};var H=D,G=n(89);var J,M=function(){var e,t,n=Object(c.useReducer)(P,{songs:[]}),r=Object(u.a)(n,2),a=r[0],s=r[1],i=Object(c.useRef)(),o=Object(c.useRef)(),l=Object(d.f)();Object(c.useEffect)((function(){var e;o.current=(e=function(){return i.current},Object(G.a)({getState:e})),o.current.on("data",(function(e){var t,n=e.action,c=e.interaction,r=(e.navigation,e.system);if("BACK"===(null===r||void 0===r?void 0:r.command)&&l.goBack(),c&&(null===c||void 0===c?void 0:c.payload))return t=c.payload,void l.push("/song/".concat(t));n&&s(n)}))}),[]),Object(c.useEffect)((function(){i.current={item_selector:{items:a.songs.map((function(e,t){var n=e._id;e.title;return{number:t+1,id:n,title:"".concat(t+1)}}))}}}),[a]);var j=Object(d.h)("/song/:songId"),b=Boolean(j),f=null===j||void 0===j||null===(e=j.params)||void 0===e?void 0:e.songId,g=null===(t=a.songs.find((function(e){return e._id===f})))||void 0===t?void 0:t.title;return Object(_.jsx)("div",{className:"App",children:Object(_.jsxs)(m.Container,{className:"container",children:[b?Object(_.jsx)(m.Header,{back:!0,title:g||"\u041f\u0435\u0441\u043d\u044f",onBackClick:function(){l.push("/")}}):Object(_.jsx)(m.Header,{back:!1,title:"\u041a\u0430\u0440\u0430\u043e\u043a\u0435"}),Object(_.jsxs)(d.c,{children:[Object(_.jsx)(d.a,{path:"/song/:songId",component:H,children:Object(_.jsx)(H,{dispatch:s,appState:a})}),Object(_.jsx)(d.a,{path:"/",exact:!0,component:F,children:Object(_.jsx)(F,{dispatch:s,appState:a})})]})]})})},U=n(86),V=n(1),z=n(87),K=n(2),W=Object(V.createGlobalStyle)(J||(J=Object(U.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),K.text,K.background,K.gradient),Y=Object(V.createGlobalStyle)(z.darkSber),q=function(){return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(W,{}),Object(_.jsx)(Y,{})]})},Q=(n(202),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,206)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))});s.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsxs)(i.DeviceThemeProvider,{children:[Object(_.jsx)(q,{}),Object(_.jsx)(o.a,{children:Object(_.jsx)(M,{})})]})}),document.getElementById("root")),Q()},79:function(e,t,n){e.exports={song_card:"styles_song_card__JdSnD",song_card__img:"styles_song_card__img__1-ujY"}}},[[204,1,2]]]);
//# sourceMappingURL=main.635bf588.chunk.js.map